{
  "name": "extas/workflow",
  "package_classes": [
    {
      "interface": "extas\\interfaces\\workflows\\schemas\\ISchemaRepository",
      "class": "extas\\components\\workflows\\schemas\\SchemaRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\schemas\\ISchemaSampleRepository",
      "class": "extas\\components\\workflows\\schemas\\SchemaSampleRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\transitions\\TransitionRepository",
      "class": "extas\\components\\workflows\\transitions\\TransitionRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\transitions\\TransitionSampleRepository",
      "class": "extas\\components\\workflows\\transitions\\TransitionSampleRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\states\\StateRepository",
      "class": "extas\\components\\workflows\\states\\StateRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\states\\StateSampleRepository",
      "class": "extas\\components\\workflows\\states\\StateSampleRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\transitions\\dispatchers\\ITransitionDispatcherRepository",
      "class": "extas\\components\\workflows\\transitions\\dispatchers\\TransitionDispatcherRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\transitions\\dispatchers\\ITransitionDispatcherSampleRepository",
      "class": "extas\\components\\workflows\\transitions\\dispatchers\\TransitionDispatcherSampleRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\entities\\EntityRepository",
      "class": "extas\\components\\workflows\\entities\\EntityRepository"
    },
    {
      "interface": "extas\\interfaces\\workflows\\entities\\EntitySampleRepository",
      "class": "extas\\components\\workflows\\entities\\EntitySampleRepository"
    }
  ],
  "plugins": [
    {
      "class": [
        "extas\\components\\plugins\\workflows\\PluginInstallSchemas",
        "extas\\components\\plugins\\workflows\\PluginInstallSchemasSamples",
        "extas\\components\\plugins\\workflows\\PluginInstallTransitions",
        "extas\\components\\plugins\\workflows\\PluginInstallTransitionsSamples",
        "extas\\components\\plugins\\workflows\\PluginInstallStates",
        "extas\\components\\plugins\\workflows\\PluginInstallStatesSamples",
        "extas\\components\\plugins\\workflows\\PluginInstallTransitionDispatchers",
        "extas\\components\\plugins\\workflows\\PluginInstallTransitionDispatcherTemplates",
        "extas\\components\\plugins\\workflows\\PluginInstallEntities",
        "extas\\components\\plugins\\workflows\\PluginInstallEntitiesSamples"
      ],
      "stage": "extas.install"
    },
    {
      "class": "extas\\components\\plugins\\repositories\\PluginFieldSampleName",
      "stage": [
        "extas.workflow_entities.create.before",
        "extas.workflow_schemas.create.before",
        "extas.workflow_states.create.before",
        "extas.workflow_transitions.create.before",
        "extas.workflow_transition_dispatchers.create.before"
      ]
    }
  ],
  "fields": [
    {
      "name": "state_to",
      "value": "",
      "before_create": [
        {
          "condition": "!=",
          "value": "@parent.state_from"
        },
        {
          "condition": "in",
          "value": {
            "repository": "workflowStateRepository",
            "method": "all",
            "query": {
              "name": "@field_value"
            },
            "field": "name"
          }
        }
      ],
      "before_update": [
        {
          "condition": "!=",
          "value": "@parent.state_from"
        },
        {
          "condition": "in",
          "value": {
            "repository": "workflowStateRepository",
            "method": "all",
            "query": {
              "name": "@field_value"
            },
            "field": "name"
          }
        }
      ],
      "parameters": {
        "subject": {
          "name": "subject",
          "value": "extas.workflow.transition"
        }
      }
    },
    {
      "name": "state_from",
      "value": "",
      "before_create": [
        {
          "condition": "in",
          "value": {
            "repository": "workflowStateRepository",
            "method": "all",
            "query": {
              "name": "@field_value"
            },
            "field": "name"
          }
        }
      ],
      "before_update": [
        {
          "condition": "in",
          "value": {
            "repository": "workflowStateRepository",
            "method": "all",
            "query": {
              "name": "@field_value"
            },
            "field": "name"
          }
        }
      ],
      "parameters": {
        "subject": {
          "name": "subject",
          "value": "extas.workflow.transition"
        }
      }
    },
    {
      "name": "name",
      "before_delete": [
        {
          "condition": "not_in",
          "value": {
            "repository": "workflowTransitionRepository",
            "method": "all",
            "query": {
              "state_to": "@field_value"
            },
            "field": "state_to"
          }
        },
        {
          "condition": "not_in",
          "value": {
            "repository": "workflowTransitionRepository",
            "method": "all",
            "query": {
              "state_from": "@field_value"
            },
            "field": "state_from"
          }
        }
      ],
      "parameters": {
        "subject": {
          "name": "subject",
          "value": "extas.workflow.state"
        }
      }
    },
    {
      "name": "transition_name",
      "before_create": [
        {
          "condition": "in",
          "value": {
            "repository": "workflowTransitionRepository",
            "method": "all",
            "query": {
              "name": "@field_value"
            },
            "field": "name"
          }
        }
      ],
      "parameters": {
        "subject": {
          "name": "subject",
          "value": "extas.workflow.transition.dispatcher"
        }
      }
    }
  ]
}